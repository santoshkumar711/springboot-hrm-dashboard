<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>

    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>

        /* RESET */
        *{
            margin:0;
            padding:0;
            box-sizing:border-box;
            font-family:"Segoe UI",sans-serif;
        }

        /* HEADER FIXED */
        .header{
            position:fixed;
            top:0;
            left:0;
            width:100%;
            height:60px;
            background:#e9e9ea;
            display:flex;
            align-items:center;
            justify-content:space-between;
            padding:0 25px;
            z-index:1000;
        }

        .logo{
            display:flex;
            align-items:center;
            gap:12px;
            font-weight:600;
            font-size:22px;
            color:#1c2556;
        }

        .logo-circle{
            width:40px;
            height:40px;
            border:3px solid #1fa3a3;
            border-radius:50%;
            display:flex;
            align-items:center;
            justify-content:center;
            color:#1fa3a3;
            font-weight:bold;
        }

        .right-icons{
         display:flex;
         align-items:center;   /* ðŸ”¥ ye main fix hai */
         gap:22px;
         font-size:18px;
         color:#444;
         }

          .right-icons a{
         display:flex;
         align-items:center;
         color:#444;
         text-decoration:none;
         transition:0.2s;
         }

         /* HOVER */
         .right-icons a:hover{
         color:#dc2626;
         transform:scale(1.15);
         }

         /* CLICK */
        .right-icons a:active{
         color:#b91c1c;
         transform:scale(0.95);
         }


        
        
        /* SIDEBAR FIXED */
        .sidebar{
            position:fixed;
            top:60px;
            left:0;
            width:260px;
            height:calc(100vh - 60px);
            background:linear-gradient(#0b1437,#081028);
            padding:20px 15px;
            overflow-y:auto;
        }

        .menu{
            list-style:none;
        }

        .menu li{
            margin-bottom:8px;
        }

        .menu a{
            display:flex;
            align-items:center;
            gap:15px;
            padding:14px 18px;
            color:#cfd6ff;
            font-size:18px;
            border-radius:12px;
            text-decoration:none;
        }

        .menu a:hover{
            background:#111c44;
        }

        .menu a.active{
            background:linear-gradient(90deg,#5a4bff,#6f63ff);
            color:white;
        }

        /* CONTENT SCROLLABLE */
        .content{
            margin-left:260px;
            margin-top:60px;
            height:calc(100vh - 60px);
            overflow-y:auto;
            padding:30px;
            background:#f5f7fb;
        }


        /* CARDS */
        .cards{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
            gap:30px;
            margin-top:20px;
            margin-bottom:40px;
        }

        .card-box{
            background:white;
            padding:22px;
            border-radius:14px;
            display:flex;
            align-items:center;
            gap:18px;
            box-shadow:0 4px 12px rgba(0,0,0,0.08);
        }

        .card-icon{
            width:55px;
            height:55px;
            border-radius:12px;
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:22px;
            color:white;
        }

        .bg1{background:#4f46e5;}
        .bg2{background:#059669;}
        .bg3{background:#dc2626;}
        .bg4{background:#d97706;}

        .card-text h3{
            font-size:24px;
        }

        .card-text p{
            font-size:14px;
            color:#666;
        }


        /* CHARTS */
        .charts{
            display:grid;
            grid-template-columns:1fr 1fr;
            gap:25px;
        }

        .chart-box{
            background:white;
            padding:20px;
            border-radius:14px;
            box-shadow:0 4px 12px rgba(0,0,0,0.08);
        }

        .chart-box h3{
            margin-bottom:15px;
        }
        .chart-box canvas{
    height:300px !important;
}
        

    </style>
</head>

<body>

<!-- HEADER -->
<div class="header">
    <div class="logo">
        <div class="logo-circle">N</div>
        Nyxora Technology
    </div>

    <div class="right-icons">
    <i class="fa-regular fa-envelope"></i>
    <i class="fa-regular fa-bell"></i>

    <a href="login.html" title="Logout">
        <i class="fa-solid fa-right-from-bracket"></i>
    </a>
</div>

</div>


<!-- SIDEBAR -->
<div class="sidebar">
    <ul class="menu">
        <li><a class="active" href="/dashboard.html"><i class="fa-solid fa-border-all"></i> Dashboard</a></li>
        <li><a href="/employees.html"><i class="fa-solid fa-users"></i> Employees</a></li>
        <li><a href="/attendance.html"><i class="fa-regular fa-calendar"></i> Attendance</a></li>
        <li><a href="/leaves.html"><i class="fa-regular fa-file-lines"></i> Leaves</a></li>
        <li><a href="/payroll.html"><i class="fa-solid fa-dollar-sign"></i> Payroll</a></li>
        <li><a href="/performance.html"><i class="fa-solid fa-chart-line"></i> Performance</a></li>
        <li><a href="/departments.html"><i class="fa-solid fa-building"></i> Departments</a></li>
        <li><a href="/reports.html"><i class="fa-solid fa-chart-bar"></i> Reports</a></li>
    </ul>
</div>


<!-- CONTENT -->
<div class="content">
    <h2>Dashboard</h2>
    <p>Welcome to your dashboard.</p>

    <div class="cards">

        <div class="card-box">
            <div class="card-icon bg1"><i class="fa-solid fa-users"></i></div>
            <div class="card-text"><h3 id="totalEmp">0</h3><p>Total Employees</p></div>
        </div>

        <div class="card-box">
            <div class="card-icon bg2"><i class="fa-solid fa-user-check"></i></div>
            <div class="card-text"><h3 id="presentEmp">0</h3><p>Present Today</p></div>
        </div>

        <div class="card-box">
            <div class="card-icon bg3"><i class="fa-solid fa-user-clock"></i></div>
            <div class="card-text"><h3 id="leaveEmp">0</h3><p>On Leave</p></div>
        </div>

        <div class="card-box">
            <div class="card-icon bg4"><i class="fa-solid fa-building"></i></div>
            <div class="card-text"><h3 id="totalDept">0</h3><p>Total Departments</p></div>
        </div>

    </div>


    <div class="charts">

        <div class="chart-box">
            <h3>Attendance Trend</h3>
            <canvas id="attendanceChart"></canvas>
        </div>

        <div class="chart-box">
            <h3>Department Distribution</h3>
            <canvas id="deptChart"></canvas>
        </div>

    </div>

</div>


<script>

const BASE_URL = window.location.origin;

let attendanceChart;
let deptChart;

window.onload=loadDashboard;

function loadDashboard(){

fetch(BASE+"/dashboard/stats")
.then(res=>res.json())
.then(data=>{

// cards
document.getElementById("totalEmp").innerText=data.employees;
document.getElementById("presentEmp").innerText=data.present;
document.getElementById("leaveEmp").innerText=data.leave;
document.getElementById("totalDept").innerText=data.departments;

// charts
renderCharts(data);

})
.catch(err=>console.log(err));

}



function renderCharts(data){

// destroy old charts (important for reload)
if(attendanceChart) attendanceChart.destroy();
if(deptChart) deptChart.destroy();


// Attendance Chart
attendanceChart=new Chart(
document.getElementById("attendanceChart"),
{
type:"bar",
data:{
labels:["Present","Leave"],
datasets:[{
label:"Employees",
data:[data.present,data.leave]
}]
}
});


// Department Chart
deptChart=new Chart(
document.getElementById("deptChart"),
{
type:"pie",
data:{
labels:["Employees","Departments"],
datasets:[{
data:[data.employees,data.departments]
}]
}
});

}

</script>


</body>
</html>
